{
  "openapi": "3.0.1",
  "info": {
    "title": "Truck Visit Management",
    "description": "This document contains the functional and technical specifications of the Truck Visit Management API. The API calls are designed to facilitate the Truck Visit Management’s Freight Management scope, which is limited to the Digital Handover Right creation and update process.",
    "termsOfService": "https://www.nallian.com/",
    "version": "v1"
  },
  "servers": [
    {
      "url": "https://{community}-prd.nallian.io/api/tvm",
      "description": "PRD - Production Environment",
      "variables": {
        "community": {
          "enum": [
            "tenant1",
            "tenant2"
          ],
          "default": "tenant1",
          "description": "Nallian has multiple domains for every application, specified by the community/tenant."
        }
      }
    },
    {
      "url": "https://{community}-stg.nallian.io/api/tvm",
      "description": "STG - Staging Environment",
      "variables": {
        "community": {
          "enum": [
            "demo"
          ],
          "default": "demo",
          "description": "Nallian has multiple domains for every application, specified by the community/tenant."
        }
      }
    }
  ],
  "paths": {
    "/v1/connect/digital-rights/pick-up": {
      "post": {
        "description": "The purpose of the “Create Digital Handover Right” call is to generate a handover right for a (group of) cargo object(s), assigned to a capacity booker and used to schedule a visit for this handover in TVM.",
        "tags": [
          "DigitalRights"
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalRights"
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalRightsId"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/CommonError"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "No relation found for provided Actors"
          }
        }
      }
    },
    "/v1/connect/digital-rights/drop-off": {
      "post": {
        "description": "The purpose of the “Create Digital Handover Right” call is to generate a handover right for a (group of) cargo object(s), assigned to a capacity booker and used to schedule a visit for this handover in TVM.",
        "tags": [
          "DigitalRights"
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalRights"
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalRightsId"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/CommonError"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "No relation found for provided Actors"
          }
        }
      }
    },
    "/v1/connect/digital-rights/{digitalRightId}": {
      "put": {
        "description": "The purpose of the “Update Digital Handover Right” call is to change a handover right for a (group of) cargo object(s), assigned to a capacity booker and used to schedule a visit for this handover in TVM. By updating this D.R., the integrator can indicate a status transition (for example confirm a handover) and/or update the content (for example the underlying cargo objects and their formation).",
        "tags": [
          "DigitalRights"
        ],
        "parameters": [
          {
            "name": "digitalRightId",
            "in": "path",
            "description": "Id of digital right that is updated",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalRights"
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted. No body"
          },
          "400": {
            "$ref": "#/components/responses/CommonError"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Message validation error"
          }
        }
      }
    },
    "/v1/connect/identification/capacity-bookers": {
      "get": {
        "description": "The purpose of the “Get Capacity Bookers” call is to retrieve a list of identification codes for all known Capacity Bookers (truckers, forwarders, etc..) who are allowed to pick-up/drop-off cargo handover rights using TVM in a specific community/station (tenant). This list will provide a universal identification method & value for every capacity booker which can be used to identify Organisations between the two integrating systems.",
        "tags": [
          "Organisations"
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Organisations"
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/v1/connect/identification/capacity-suppliers": {
      "get": {
        "description": "Provide a list of capacity suppliers to be used in the digital right creation",
        "tags": [
          "Organisations"
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Organisations"
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/v1/connect/lookups/digital-right-states": {
      "get": {
        "description": "Provide a list of digital right state and their corresponding name.",
        "tags": [
          "Lookup"
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "integer"
                      },
                      "name": {
                        "type": "string",
                        "nullable": true
                      }
                    }
                  }
                },
                "example": [
                  {
                    "id": 22,
                    "name": "Expected"
                  },
                  {
                    "id": 23,
                    "name": "Temporarily blocked"
                  },
                  {
                    "id": 24,
                    "name": "Available for handover"
                  },
                  {
                    "id": 25,
                    "name": "Unavailable/void"
                  },
                  {
                    "id": 26,
                    "name": "Handover complete"
                  }
                ]
              }
            }
          }
        }
      }
    },
    "/v1/connect/lookups/digital-right-types": {
      "get": {
        "description": "Provide a list of digital right type and their corresponding name.",
        "tags": [
          "Lookup"
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "integer"
                      },
                      "name": {
                        "type": "string",
                        "nullable": true
                      }
                    }
                  }
                },
                "example": [
                  {
                    "id": 13,
                    "name": "Intact Uld"
                  },
                  {
                    "id": 14,
                    "name": "Loose Cargo"
                  },
                  {
                    "id": 15,
                    "name": "Pallet Stack"
                  }
                ]
              }
            }
          }
        }
      }
    },
    "/v1/connect/lookups/handover-types": {
      "get": {
        "description": "Provide a list of digital handover right type and their corresponding name.",
        "tags": [
          "Lookup"
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "integer"
                      },
                      "name": {
                        "type": "string",
                        "nullable": true
                      }
                    }
                  }
                },
                "example": [
                  {
                    "id": 11,
                    "name": "Pick-up"
                  },
                  {
                    "id": 12,
                    "name": "Delivery"
                  }
                ]
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "DigitalRights": {
        "type": "object",
        "additionalProperties": false,
        "x-stoplight": {
          "id": "a6c7b53cf47b6"
        },
        "properties": {
          "externalReference": {
            "type": "string",
            "description": "External reference used to identify the digital righin the external application .External refere must be unique nce "
          },
          "rightState": {
            "type": "integer"
          },
          "totalPieces": {
            "type": "integer"
          },
          "totalWeight": {
            "type": "number"
          },
          "volume": {
            "type": "number"
          },
          "length": {
            "type": "number"
          },
          "height": {
            "type": "number"
          },
          "width": {
            "type": "number"
          },
          "assignee": {
            "type": "object",
            "properties": {
              "nallianId": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          "capacitySupplier": {
            "type": "object",
            "properties": {
              "nallianId": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          "airShipments": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AirShipments"
            }
          },
          "ulds": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ulds"
            }
          },
          "viewers": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "nallianId": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          }
        },
        "required": [
          "externalReference",
          "rightState",
          "totalPieces",
          "totalWeight",
          "assignee",
          "capacitySupplier"
        ]
      },
      "DigitalRightsId": {
        "type": "object",
        "properties": {
          "rightId": {
            "type": "string",
            "format": "uuid"
          }
        },
        "additionalProperties": false,
        "x-stoplight": {
          "id": "74035d5add35a"
        }
      },
      "Organisations": {
        "type": "object",
        "properties": {
          "nallianId": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "city": {
            "type": "string"
          },
          "country": {
            "type": "string"
          },
          "identificationCodes": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string"
                },
                "value": {
                  "type": "string"
                }
              }
            }
          }
        },
        "additionalProperties": false,
        "x-stoplight": {
          "id": "deb25e3ac6e86"
        }
      },
      "AirShipments": {
        "type": "object",
        "properties": {
          "shipmentReference": {
            "type": "string",
            "nullable": true
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "flights": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Flights"
            },
            "nullable": true
          },
          "volume": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "length": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "height": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "width": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "sphs": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          },
          "pieces": {
            "type": "integer",
            "format": "int32"
          },
          "weight": {
            "type": "number",
            "format": "double"
          },
          "extraInformation": {
            "type": "object",
            "properties": {
              "chargesPayed": {
                "type": "boolean"
              },
              "customsReleased": {
                "type": "boolean"
              },
              "readyForRelease": {
                "type": "boolean"
              }
            }
          },
          "mawb": {
            "$ref": "#/components/schemas/Mawbs"
          },
          "hawbs": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Hawbs"
            },
            "nullable": true
          }
        },
        "additionalProperties": false,
        "x-stoplight": {
          "id": "b344cfe7eebbd"
        }
      },
      "Flights": {
        "required": [
          "flightNumber"
        ],
        "type": "object",
        "properties": {
          "sta": {
            "type": "string",
            "format": "date-time"
          },
          "std": {
            "type": "string",
            "format": "date-time"
          },
          "flightNumber": {
            "type": "string"
          },
          "destination": {
            "type": "string"
          },
          "origin": {
            "type": "string"
          }
        },
        "additionalProperties": false,
        "x-stoplight": {
          "id": "b40f07a51ef5c"
        }
      },
      "Hawbs": {
        "type": "object",
        "properties": {
          "hawbNumber": {
            "type": "string",
            "nullable": true
          },
          "origin": {
            "type": "string",
            "nullable": true
          },
          "destination": {
            "type": "string",
            "nullable": true
          },
          "pieces": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "weight": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "sphs": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          }
        },
        "additionalProperties": false,
        "x-stoplight": {
          "id": "4b23bc1e557b9"
        }
      },
      "Mawbs": {
        "type": "object",
        "properties": {
          "mawbNumber": {
            "type": "string",
            "nullable": true
          },
          "origin": {
            "type": "string",
            "nullable": true
          },
          "destination": {
            "type": "string",
            "nullable": true
          },
          "externalReference": {
            "type": "string",
            "nullable": true
          },
          "pieces": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "weight": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "sphs": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          },
          "agent": {
            "type": "object",
            "properties": {
              "nallianId": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        },
        "additionalProperties": false,
        "x-stoplight": {
          "id": "0b229739bfc2e"
        }
      },
      "Ulds": {
        "type": "object",
        "properties": {
          "externalReference": {
            "type": "string",
            "nullable": true
          },
          "uldSerialNumber": {
            "type": "string",
            "nullable": true
          },
          "prefix": {
            "type": "string",
            "nullable": true
          },
          "uldCode": {
            "type": "string",
            "nullable": true
          },
          "uldType": {
            "type": "string",
            "nullable": true
          },
          "isPallet": {
            "type": "boolean"
          }
        },
        "additionalProperties": false,
        "x-stoplight": {
          "id": "8c27d356f4825"
        }
      }
    },
    "responses": {
      "CommonError": {
        "description": "Bad request",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "code": {
                  "type": "string",
                  "nullable": true
                },
                "key": {
                  "type": "string",
                  "nullable": true
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "nullable": true
                }
              }
            }
          }
        }
      }
    },
    "examples": {
      "digital-right-states-response": {
        "value": 
          [
                  {
                    "id": 22,
                    "name": "Expected"
                  },
                  {
                    "id": 23,
                    "name": "Temporarily blocked"
                  },
                  {
                    "id": 24,
                    "name": "Available for handover"
                  },
                  {
                    "id": 25,
                    "name": "Unavailable/void"
                  },
                  {
                    "id": 26,
                    "name": "Handover complete"
                  }
        ]
      }
    }
  },
  "tags": [
    {
      "name": "DigitalRights",
      "description": "endpoints to create/update digital handling right"
    },
    {
      "name": "Organisations"
    },
    {
      "name": "Lookup",
      "description": "endpoints to retrieve type description"
    }
  ]
}